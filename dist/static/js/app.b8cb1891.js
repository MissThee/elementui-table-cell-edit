!function(e){function n(n){for(var i,o,d=n[0],a=n[1],s=n[2],p=0,u=[];p<d.length;p++)o=d[p],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&u.push(r[o][0]),r[o]=0;for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i]);for(c&&c(n);u.length;)u.shift()();return l.push.apply(l,s||[]),t()}function t(){for(var e,n=0;n<l.length;n++){for(var t=l[n],i=!0,d=1;d<t.length;d++){var a=t[d];0!==r[a]&&(i=!1)}i&&(l.splice(n--,1),e=o(o.s=t[0]))}return e}var i={},r={app:0},l=[];function o(n){if(i[n])return i[n].exports;var t=i[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=e,o.c=i,o.d=function(e,n,t){o.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,n){if(1&n&&(e=o(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)o.d(t,i,function(n){return e[n]}.bind(null,i));return t},o.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(n,"a",n),n},o.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},o.p="";var d=window.webpackJsonp=window.webpackJsonp||[],a=d.push.bind(d);d.push=n,d=d.slice();for(var s=0;s<d.length;s++)n(d[s]);var c=a;l.push([0,"chunk-vendors"]),t()}({0:function(e,n,t){e.exports=t("56d7")},"06b4":function(e,n,t){n=e.exports=t("24fb")(!0);var i=t("1de5"),r=t("eecd"),l=t("06d4"),o=t("549a"),d=i(r),a=i(l),s=i(o);n.push([e.i,"*[data-v-351764dc],div[data-v-351764dc],input[data-v-351764dc],span[data-v-351764dc],td[data-v-351764dc]{font-size:14px;font-family:Arial,Microsoft YaHei,serif}.el-table[data-v-351764dc] td{padding:0;line-height:30px;height:30px}.el-table[data-v-351764dc] .cell{-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;text-overflow:ellipsis;white-space:normal;word-break:break-all;line-height:30px;padding:0 0 0 10px}[data-v-351764dc] .el-input__inner{padding:0;font-size:14px;box-sizing:border-box;height:30px;line-height:30px}[data-v-351764dc] .el-input__prefix,[data-v-351764dc] .el-input__suffix{display:none}.el-button--mini[data-v-351764dc],.el-button--mini.is-round[data-v-351764dc]{padding:5px 5px}[data-v-351764dc] .pre-add-row /deep/ td{background-image:url("+d+")!important}[data-v-351764dc] .pre-add-row /deep/ td,[data-v-351764dc] .pre-delete-row /deep/ td{background-position:0 0;background-size:8px;background-repeat:no-repeat}[data-v-351764dc] .pre-delete-row /deep/ td{background-image:url("+a+")!important}[data-v-351764dc] .pre-update-cell{background-image:url("+s+");background-position:0 0;background-size:8px;background-repeat:no-repeat}[data-v-351764dc] input::-webkit-inner-spin-button,[data-v-351764dc] input::-webkit-outer-spin-button{-webkit-appearance:none}[data-v-351764dc] input[type=number]{-moz-appearance:textfield}","",{version:3,sources:["P:/elementui-table-cell-edit/src/src/TableCellEdit.vue"],names:[],mappings:"AAqtBA,yGACA,cAAA,CACA,uCACA,CAGA,8BACA,SAAA,CACA,gBAAA,CACA,WACA,CAGA,iCACA,6BAAA,CACA,qBAAA,CACA,eAAA,CACA,sBAAA,CACA,kBAAA,CACA,oBAAA,CACA,gBAAA,CACA,kBACA,CAGA,mCACA,SAAA,CACA,cAAA,CACA,qBAAA,CACA,WAAA,CACA,gBACA,CAOA,wEACA,YACA,CAGA,6EACA,eACA,CAEA,yCAEA,6DAIA,CAEA,qFALA,uBAAA,CACA,mBAAA,CACA,2BASA,CANA,4CAEA,6DAIA,CAEA,mCAEA,mDAAA,CACA,uBAAA,CACA,mBAAA,CACA,2BACA,CAGA,sGAEA,uBACA,CAEA,qCACA,yBACA",file:"TableCellEdit.vue?vue&type=style&index=0&id=351764dc&scoped=true&lang=css&",sourcesContent:['<template>\r\n  <div>\r\n    <el-form inline style="height:20px;">\r\n      <el-form-item style="margin-bottom: 0">\r\n        <el-button class="custom-button-in-toolbar " type="primary" plain size="mini" icon="el-icon-refresh"\r\n                   @click="refreshData">刷新\r\n        </el-button>\r\n      </el-form-item>\r\n      <el-form-item style="margin-bottom: 0">\r\n        <el-button type="primary" plain size="mini" icon="el-icon-circle-plus" @click="addNewRowHandler">新增</el-button>\r\n      </el-form-item>\r\n      <el-form-item style="margin-bottom: 0">\r\n        <el-button type="success" plain size="mini" icon="el-icon-success" @click="submitHandler">提交保存</el-button>\r\n      </el-form-item>\r\n      <el-form-item style="float:right;margin-bottom: 0">\r\n        <el-popover trigger="hover" placement="bottom">\r\n          <el-button slot="reference" type="warning" plain size="mini"><i class="el-icon-question"/>使用帮助</el-button>\r\n          <div style="height: 25px">\r\n            <span style="color:#ff7435;display: inline-block;font-weight: bold;">所有操作均在“提交保存”后生效</span>\r\n          </div>\r\n          <div style="height: 25px">\r\n            <span style="display: inline-block;font-weight: bold;width: 70px">角标颜色</span>\r\n            <el-tag style="font-size: 12px;margin-right: 5px" size="mini">预增加</el-tag>\r\n            <el-tag style="font-size: 12px;margin-right: 5px" size="mini" type="warning">预修改</el-tag>\r\n            <el-tag style="font-size: 12px;margin-right: 5px" size="mini" type="danger">预删除</el-tag>\r\n          </div>\r\n          <div style="height: 25px">\r\n            <span style="font-weight: bold;color:#666">快捷键（编辑单元格时）：</span>\r\n          </div>\r\n          <div style="margin-left: 5px">\r\n            <div style="height: 25px">\r\n              <span style="display: inline-block;font-weight: bold;width: 80px">下一单元格</span>\r\n              <el-tag style="font-size: 12px;margin:0 5px" size="mini">Tab</el-tag>\r\n            </div>\r\n            <div style="height: 25px">\r\n              <span style="display: inline-block;font-weight: bold;width: 80px">上一单元格</span>\r\n              <el-tag style="font-size: 12px;margin:0 5px" size="mini">Shift</el-tag>\r\n              <span>+</span>\r\n              <el-tag style="font-size: 12px;margin:0 5px" size="mini">Tab</el-tag>\r\n            </div>\r\n            <div style="height: 25px">\r\n              <span style="display: inline-block;font-weight: bold;width: 80px">撤销修改</span>\r\n              <el-tag style="font-size: 12px;margin:0 5px" size="mini">Shift</el-tag>\r\n              <span>+</span>\r\n              <el-tag style="font-size: 12px;margin:0 5px" size="mini">Backspace</el-tag>\r\n            </div>\r\n            <div style="height: 25px">\r\n              <span style="display: inline-block;font-weight: bold;width: 80px">完成编辑</span>\r\n              <el-tag style="font-size: 12px;margin:0 5px" size="mini">Esc</el-tag>\r\n            </div>\r\n          </div>\r\n        </el-popover>\r\n      </el-form-item>\r\n    </el-form>\r\n    <el-table\r\n      :data="tableData"\r\n      ref="Table"\r\n      border\r\n      style="width: 100%"\r\n      height="400px"\r\n      :row-class-name="tableRowClassName"\r\n      :cell-class-name="tableCellClassName"\r\n    >\r\n      <el-table-column fixed="left" type="index" width="50px" label="序号" align="center"/>\r\n      <el-table-column v-for="item in columnOption" :min-width="item.minWidth" :width="item.width"\r\n                       :column-key="item.columnKey" :label="item.label" :key="item.prop" :prop="item.propText">\r\n        <template slot-scope="scope">\r\n          <div @click="cellClickHandler(scope.row,item)" style="min-height: 30px" :style="{color:item.color}"\r\n               v-show="!isEditingCell(scope.row._hiddenRowId,item.columnKey,item.editType)">\r\n            <span>{{scope.row[item.propText]}}</span>\r\n          </div>\r\n          <div style="display: table" v-if="isEditingCell(scope.row._hiddenRowId,item.columnKey,item.editType)">\r\n            <div style="display: table-cell;width: 100%">\r\n              <input v-if="item.editType===\'Input\'"\r\n                     class="el-input el-input__inner"\r\n                     style="width:100%"\r\n                     @blur="editCellBlurHandler"\r\n                     :ref="buildCellRef(scope.row._hiddenRowId,item.columnKey)"\r\n              />\r\n              <input v-if="item.editType===\'InputNumber\'"\r\n                     class="el-input el-input__inner"\r\n                     style="width:100%"\r\n                     type="Number"\r\n                     @blur="editCellBlurHandler"\r\n                     :ref="buildCellRef(scope.row._hiddenRowId,item.columnKey)"\r\n                     placeholder="输入数字"/>\r\n              <el-date-picker v-if="item.editType===\'DatePicker\'"\r\n                              style="width:100%"\r\n                              @blur="editCellBlurHandler"\r\n                              :ref="buildCellRef(scope.row._hiddenRowId,item.columnKey)"\r\n                              v-model="scope.row[item.propId]"\r\n                              :clearable="false" size="mini" prefix-icon=" " placeholder="选择日期" format="yyyy-MM-dd"\r\n                              value-format="yyyy-MM-dd"/>\r\n              <el-select v-if="item.editType===\'Select\'"\r\n                         width="100%"\r\n                         filterable\r\n                         @blur="editCellBlurHandler"\r\n                         @change="editCellBlurHandler"\r\n                         :ref="buildCellRef(scope.row._hiddenRowId,item.columnKey)"\r\n                         v-model="scope.row[item.propId]"\r\n                         :automatic-dropdown="true"\r\n                         placeholder="请选择">\r\n                <el-option v-for="selectItem in item.selectList" :key="selectItem.value" :label="selectItem.label"\r\n                           :value="selectItem.value"/>\r\n              </el-select>\r\n            </div>\r\n            <div style="margin: 0;" :style="{width:getRowState(scope.row._hiddenRowId)===\'add\'?0:26+\'px\'}">\r\n              <el-popconfirm placement="right" @onConfirm="revokeEditingValueHandler" title="确定撤销更改？">\r\n                <el-button v-if="getRowState(scope.row._hiddenRowId)!==\'add\'" slot="reference" style="margin: 0;"\r\n                           title="撤销更改(Shift+Backspace)" type="danger" plain size="mini" icon="el-icon-refresh-left"/>\r\n              </el-popconfirm>\r\n            </div>\r\n          </div>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column width="120px" prop="selectValue" align="center" label="选择id(普通列)"/>\r\n      <el-table-column width="120px" prop="selectName" align="center" label="选择值(普通列)"/>\r\n      <el-table-column width="60px" fixed="right" align="center" label="操作">\r\n        <template slot-scope="scope">\r\n          <el-button :title="getRowState(scope.row._hiddenRowId)===\'delete\'?\'取消删除\':\'删除\'"\r\n                     style="margin-left: -10px;font-size: 12px"\r\n                     :type="getRowState(scope.row._hiddenRowId)===\'delete\'?\'success\':\'danger\'" plain size="mini"\r\n                     :icon="getRowState(scope.row._hiddenRowId)===\'delete\'?\'el-icon-refresh-left\':\'el-icon-delete\'"\r\n                     @click="deleteRowHandler(scope.row)"/>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import axios from \'axios\'\r\n\r\n  export default {\r\n    name: \'TableCellEdit\',\r\n    data() {\r\n      return {\r\n        tableData: undefined,//table当前数据\r\n        tableDataOrigin: [],//table原数据，做撤销时使用\r\n        editingCellInfo: {//记录当前编辑中的单元格坐标信息\r\n          rowId: undefined,\r\n          columnId: undefined,\r\n          columnOption: undefined\r\n        },\r\n        changedCellInfo: {// 记录已修改单元格的集合\r\n          // \'rowId\': {//行标识\r\n          //   \'columnId1\': \'propId1\',//列标识 ： 列的数据字段\r\n          //   \'columnId2\': \'propId2\',//列标识 ： 列的数据字段\r\n          // }\r\n        },\r\n        dataPrimaryKey: "id",//数据的主键字段，即区分每行数据的标识字段\r\n        columnOption: [ //列配置\r\n          {\r\n            columnKey: "column1",\r\n            minWidth: "100px",\r\n            label: \'文字\',\r\n            propId: \'text\',\r\n            propText: \'text\',\r\n            editType: \'Input\',\r\n          }, {\r\n            columnKey: "column2",\r\n            minWidth: "100px",\r\n            label: \'文字1\',\r\n            propId: \'text1\',\r\n            propText: \'text1\',\r\n            editType: \'Input\',\r\n          }, {\r\n            //以下为单元格编辑关键配置：\r\n            columnKey: "column3",//列标识，每列互相不重复即可。\r\n            propId: \'date\',   //编辑时绑定的数据字段（这个字段需要为数据中的字段名，并且也是本列编辑后回传的字段名）\r\n            propText: \'date\', //非编辑时展示的数据字段（这个字段需要为数据中的字段名）\r\n            editType: \'DatePicker\',//编辑类型，现有固定的几种Input，InputNumber，Select，DatePicker。没有editType则此列不能进入编辑模式。若有值且不是以上值则编辑出bug\r\n            //以下为element-ui的table原有的列配置字段引用的值。（只是在el-table-column中引用了值）\r\n            width: "150px",\r\n            minWidth: "150px",\r\n            label: \'时间编辑\',\r\n          }, {\r\n            columnKey: "column4",\r\n            minWidth: "100px",\r\n            label: \'数字\',\r\n            propId: \'number\',\r\n            propText: \'number\',\r\n            editType: \'InputNumber\',\r\n          }, {\r\n            columnKey: "column5",\r\n            minWidth: "140px",\r\n            label: \'不能编辑\',\r\n            propId: \'textNoEdit\',\r\n            propText: \'textNoEdit\',\r\n          }, {\r\n            columnKey: "column6",\r\n            minWidth: "100px",\r\n            label: \'选择\',\r\n            propId: \'selectValue\',\r\n            propText: \'selectName\',\r\n            editType: \'Select\',\r\n            selectList: [//选择列表，需要在此提供列表数据\r\n              {\r\n                value: 10,\r\n                label: \'这个选项会被fetchSelectListData()方法中的值覆盖\'\r\n              },\r\n            ],\r\n          },],\r\n        //辅助参数，记录当前列表中最后一行的 行标识序号，新增时，新行参照这个序号继续增加\r\n        newRowHiddenId: 1,\r\n        //辅助参数，控制tab键一直按住，也不会重复触发切换单元格\r\n        tabKeyAlreadyDown: false,\r\n      };\r\n    },\r\n    mounted() {\r\n    },\r\n    created() {\r\n      this.preventLeavingPage();\r\n      this.fetchData();\r\n      this.fetchSelectListData()\r\n    },\r\n\r\n    methods: {\r\n      refreshData() {\r\n        if (JSON.stringify(this.changedCellInfo) !== (\'{}\')) {\r\n          this.$confirm(\'检测到您有未提交保存的修改<br />刷新将<span style="color:#E6A23C;font-weight: bold">丢失未保存的修改</span>，是否继续？\',\r\n            {dangerouslyUseHTMLString: true})\r\n            .then(() => {\r\n              this.fetchData();\r\n            })\r\n            .catch(() => {\r\n            });\r\n        } else {\r\n          this.fetchData();\r\n        }\r\n      },\r\n      fetchData() {// 获取数据\r\n        axios.post(\'/getTableDataApi\').then(({data}) => {\r\n          this.setTableData(data.tableData);\r\n        })\r\n      },\r\n      fetchSelectListData() {// 获取下拉列表数据\r\n        axios.post(\'/getSelectListDataApi\').then(({data}) => {\r\n          this.columnOption.forEach(e => {\r\n            if (e.columnKey === \'column6\') {\r\n              e.selectList = data.selectListData;\r\n            }\r\n          })\r\n        })\r\n      },\r\n      submitHandler() {//提交结果\r\n        let submitData = this.getEditResult();\r\n        axios.post(\'/setTableDataApi\', submitData).then(({data}) => {\r\n          if (data.result) {\r\n            this.fetchData();\r\n            console.info(\'提交了信息\', submitData);\r\n            this.$notify({\r\n              title: \'提交成功，查看控制台\',\r\n              type: \'success\'\r\n            });\r\n          }\r\n        })\r\n      },\r\n      //---------------------------------------------以下为单元格编辑支持方法---------------------------------------------\r\n      setTableData(tableData) {//设置表格数据\r\n        this.resetCell();\r\n        this.tableData = tableData;\r\n        this.initTableDataAndTableDataOrigin();\r\n      },\r\n      getRowState(_hiddenRowId) {//使用_hiddenRowId获取当前行的状态，\r\n        // 已有数据初始或被修改过值得行，_hiddenRowId均为纯数字\r\n        // 被删除的行_hiddenRowId值为字母D开头\r\n        // 新增加的行_hiddenRowId值为字母A开头\r\n        if (!_hiddenRowId) {\r\n          return \'\';\r\n        } else if (_hiddenRowId.startsWith(\'D\')) {\r\n          return \'delete\';\r\n        } else if (_hiddenRowId.startsWith(\'A\')) {\r\n          return \'add\';\r\n        }\r\n      },\r\n      tableRowClassName({row, rowIndex}) {\r\n        if (!row._hiddenRowId) {\r\n          return \'\';\r\n        } else if (row._hiddenRowId.startsWith(\'A\')) {\r\n          return \'pre-add-row\';\r\n        } else if (row._hiddenRowId.startsWith(\'D\')) {\r\n          return \'pre-delete-row\';\r\n        }\r\n        return \'\';\r\n      },\r\n      tableCellClassName({row, column, rowIndex, columnIndex}) {\r\n        let classNames = \'\';\r\n        if (this.changedCellInfo[row._hiddenRowId] && this.changedCellInfo[row._hiddenRowId][column.columnKey]) {\r\n          classNames += \' pre-update-cell\';        //被修改的单元格角标样式\r\n        }\r\n        return classNames;\r\n      },\r\n      buildNewRowHiddenId() {\r\n        let newRowHiddenId = \'A\' + (Array(16)\r\n          .join(\'0\') + this.newRowHiddenId).slice(-16);\r\n        this.newRowHiddenId++;\r\n        return newRowHiddenId;\r\n      },\r\n      //table原数据加自定义_hiddenRowId列，单元格编辑的辅助定位参数。并留存原数据副本tableDataOrigin，用以编辑时撤销编辑，恢复内容[需在获取数据后马上调用]\r\n      initTableDataAndTableDataOrigin() {\r\n        let i = 1;\r\n        for (let row of this.tableData) {\r\n          //_hiddenRowId为定位行的辅助参数，请求的数据中不能包含此字段\r\n          this.$set(row, \'_hiddenRowId\', (Array(16).join(\'0\') + i).slice(-16));\r\n          i++;\r\n        }\r\n        this.tableDataOrigin = JSON.parse(JSON.stringify(this.tableData));\r\n      },\r\n      //通过行列坐标构建ref值的方法\r\n      buildCellRef(_hiddenRowId, columnId) {\r\n        // console.log(\'buildCellRef\',_hiddenRowId, columnId);\r\n        return \'Cell_\' + _hiddenRowId + \'_\' + columnId;\r\n      },\r\n      //单元格编辑状态 开关\r\n      isEditingCell(rowId, columnId, editType) {\r\n        return editType\r\n          && this.editingCellInfo.rowId === rowId\r\n          && this.editingCellInfo.columnId === columnId;\r\n      },\r\n      cellClickHandler(row, item) {\r\n        // console.log(\'row, column\', row, item);\r\n        this.startEdit(row, item);\r\n      },\r\n      //开始编辑(设置编辑中单元格信息)\r\n      startEdit(row, item) {\r\n        this.setEditKeyListener(false);\r\n        this.setEditKeyListener(true);\r\n        {//设置编辑中单元格 定位参数\r\n          if (row && row._hiddenRowId) {\r\n            this.editingCellInfo.rowId = row._hiddenRowId;\r\n          }\r\n          if (item && item.columnKey) {\r\n            this.editingCellInfo.columnId = item.columnKey;\r\n          }\r\n          if (item) {\r\n            this.editingCellInfo.columnOption = item;\r\n          }\r\n        }\r\n        this.editingCellFocusAndSelect();\r\n        // console.log(\'开始编辑\', column.columnKey);\r\n      },\r\n      //完成编辑（清除单元格编辑状态，清除按键监听事件）\r\n      finishEdit() {\r\n        this.editCellBlurHandler();\r\n        this.editingCellInfo = {\r\n          rowId: undefined,\r\n          columnId: undefined,\r\n          columnOption: undefined,\r\n        };\r\n        this.setEditKeyListener(false);\r\n      },\r\n      //编辑中单元格 焦点获取,文字选中\r\n      editingCellFocusAndSelect() {\r\n        let _hiddenRowId = this.editingCellInfo.rowId;\r\n        let columnId = this.editingCellInfo.columnId;\r\n        this.$nextTick(() => {\r\n          //以row._hiddenRowId，column.columnKey，发现单元格。\r\n          if (this.editingCellInfo.columnOption) {\r\n            switch (this.editingCellInfo.columnOption.editType) {\r\n              case \'Input\':\r\n              case \'InputNumber\':\r\n                let cellValue = this.tableData.find(e => e._hiddenRowId === this.editingCellInfo.rowId)[this.editingCellInfo.columnOption.propId];\r\n                this.$refs[this.buildCellRef(this.editingCellInfo.rowId, this.editingCellInfo.columnId)][0].value = cellValue === undefined ? \'\' : cellValue;\r\n            }\r\n          }\r\n          let cellEditorELArray = this.$refs[this.buildCellRef(_hiddenRowId, columnId)];\r\n          if (cellEditorELArray && cellEditorELArray.length > 0) {\r\n            if (cellEditorELArray[0].focus) {\r\n              cellEditorELArray[0].focus();\r\n            }\r\n            if (cellEditorELArray[0].select) {\r\n              cellEditorELArray[0].select();\r\n            }\r\n          }\r\n        });\r\n      },\r\n      //编辑中单元格失去焦点事件\r\n      editCellBlurHandler() {\r\n        // console.log("blur!!")\r\n        this.setEditingValueToTableData();\r\n        this.setEditingCellInfoToChangedCellInfo(this.checkEditingValueIsChanged());\r\n      },\r\n      setEditingValueToTableData() {\r\n        let columnOption = this.editingCellInfo.columnOption;\r\n        if (columnOption) {\r\n          let row = this.getEditingRow();\r\n          switch (columnOption.editType) {\r\n            case \'Input\':\r\n            case \'InputNumber\':\r\n              let changeValue = this.$refs[this.buildCellRef(this.editingCellInfo.rowId, this.editingCellInfo.columnId)][0].value;\r\n              this.$set(row, columnOption.propId, changeValue);\r\n              break;\r\n            case \'Select\':\r\n            case \'SelectGroup\':\r\n              let selectList = columnOption.selectList;\r\n              let newText = null;\r\n              for (let selectItem of selectList) {\r\n                if (selectItem.value === row[columnOption.propId]) {\r\n                  newText = selectItem.label;\r\n                }\r\n              }\r\n              if (columnOption.selectList.findIndex(e => e.value === row[columnOption.propId]) >= 0) {\r\n                this.$set(row, columnOption.propId, row[columnOption.propId]);\r\n                this.$set(row, columnOption.propText, newText);\r\n              }\r\n              break;\r\n          }\r\n        }\r\n      },\r\n      //记录 被修改、值有误 等单元格信息到this.changedCellInfo中。\r\n      setEditingCellInfoToChangedCellInfo(isAdd) {\r\n        if (this.editingCellInfo.columnOption) {\r\n          let rowId = this.editingCellInfo.rowId;\r\n          let columnId = this.editingCellInfo.columnId;\r\n          let propId = this.editingCellInfo.columnOption.propId;//propId为要修改的数据。因为可能出现两列绑定同一个数据，列用columnKey区分，数据字段用propId记录\r\n          if (!this.changedCellInfo[rowId]) {\r\n            this.changedCellInfo[rowId] = {};\r\n          }\r\n          if (isAdd) {\r\n            this.changedCellInfo[rowId][columnId] = propId;\r\n          } else {\r\n            delete this.changedCellInfo[rowId][columnId];\r\n            if (Object.keys(this.changedCellInfo[rowId]).length === 0) {\r\n              delete this.changedCellInfo[rowId];\r\n            }\r\n          }\r\n        }\r\n      },\r\n      //将编辑中单元格 还原到未修改时的值\r\n      revokeEditingValueHandler() {\r\n        let columnOption = this.editingCellInfo.columnOption;\r\n        let propId = columnOption.propId;\r\n        let propText = columnOption.propText;\r\n        for (let rowOrigin of this.tableDataOrigin) {\r\n          if (rowOrigin._hiddenRowId === this.editingCellInfo.rowId) {\r\n            let row = this.getEditingRow();\r\n            this.$set(row, propId, rowOrigin[propId]);\r\n            this.$set(row, propText, rowOrigin[propText]);\r\n            {//将input类型的编辑框中值也重置，因为没使用v-model绑定变量，要手动重置\r\n              switch (columnOption.editType) {\r\n                case \'Input\':\r\n                case \'InputNumber\':\r\n                  this.$refs[this.buildCellRef(this.editingCellInfo.rowId, this.editingCellInfo.columnId)][0].value = rowOrigin[propId];\r\n                  break;\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n        this.finishEdit();//撤销完失去焦点\r\n        // this.$refs[this.buildCellRef(this.editingCellInfo.rowId, this.editingCellInfo.columnId)][0].focus();//撤销完保持焦点\r\n      },\r\n      //切换正在编辑的单元格到下一个（direction>0）或上一个（direction<0）。\r\n      switchEditColumnHandler(direction) {\r\n        // console.log(\'Tab切换单元格\', this.editingCellInfo.rowId, this.editingCellInfo.columnId, this.editingCellInfo.columnKey);\r\n        let columnOptionOnlyCanEdit = this.columnOption.filter(e => e.editType);\r\n        if (this.editingCellInfo.rowId && this.editingCellInfo.columnId) {\r\n          for (let i = 0; i < columnOptionOnlyCanEdit.length; i++) {\r\n            if (columnOptionOnlyCanEdit[i].columnKey === this.editingCellInfo.columnId) {\r\n              let next = i;\r\n              if (direction > 0) {\r\n                next++;\r\n              } else if (direction < 0) {\r\n                next--;\r\n              }\r\n\r\n              if (direction > 0 && next < columnOptionOnlyCanEdit.length || direction < 0 && next >= 0) {\r\n                //跳下一个单元格\r\n                if (columnOptionOnlyCanEdit[next]) {\r\n                  this.$refs[this.buildCellRef(this.editingCellInfo.rowId, this.editingCellInfo.columnId)][0].blur();\r\n                  if (this.editingCellInfo.columnOption.editType === \'DatePicker\') {\r\n                    //焦点到el-date-picker控件，使用方向键修改日期后，不使用回车选中，而是直接tab切换下一单元格不会触发blur事件，但选中的时间已经修改\r\n                    //在此直接调用一次blur事件\r\n                    //(el-select控件使用以上操作方式也不会触发blur，但其选中的值不会被改变，无需将其做类似处理)\r\n                    this.editCellBlurHandler();\r\n                  }\r\n                  this.startEdit(undefined, columnOptionOnlyCanEdit[next]);\r\n                }\r\n              } else {\r\n                //跳行\r\n                let rowIndex = 0;\r\n                for (; rowIndex < this.tableData.length; rowIndex++) {\r\n                  if (this.tableData[rowIndex]._hiddenRowId === this.editingCellInfo.rowId) {\r\n                    break;\r\n                  }\r\n                }\r\n                if (direction > 0) {\r\n                  if (rowIndex >= this.tableData.length - 1) {\r\n                    this.addNewRowHandler();//超过最后一行时增加新行\r\n                  }\r\n                  let nextRow = this.tableData[++rowIndex];\r\n                  this.startEdit(nextRow, columnOptionOnlyCanEdit[0]);\r\n                } else if (direction < 0) {\r\n                  if (rowIndex > 0) {\r\n                    let preRow = this.tableData[--rowIndex];\r\n                    this.startEdit(preRow, columnOptionOnlyCanEdit.slice(-1)[0]);\r\n                  } else {\r\n                  }\r\n                }\r\n              }\r\n              // this.editingCellFocusAndSelect();\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      },\r\n      // 添加/删除键盘监听事件（目的是为了仅在表格进入编辑状态时，才进行按键事件监听）\r\n      setEditKeyListener(isAdd) {\r\n        if (isAdd) {\r\n          window.addEventListener(\'keydown\', this.editCellKeyDownHandler, true);\r\n          window.addEventListener(\'keyup\', this.editCellKeyUpHandler, true);\r\n        } else {\r\n          try {\r\n            window.removeEventListener(\'keydown\', this.editCellKeyDownHandler, true);\r\n            window.removeEventListener(\'keyup\', this.editCellKeyUpHandler, true);\r\n          } catch (e) {\r\n          }\r\n        }\r\n      },\r\n      //键盘事件\r\n      editCellKeyUpHandler(event) {\r\n        if (event.key === \'Tab\' || event.keyCode === 9) {\r\n          this.tabKeyAlreadyDown = false;\r\n        }\r\n      },\r\n      //键盘事件。表格编辑快捷键操作\r\n      editCellKeyDownHandler(event) {\r\n        // console.log(\'按键值\', event.key, event.keyCode);\r\n        let needPreventDefault = false;\r\n        //Tab切换单元格\r\n        if ((event.key === \'Tab\' || event.keyCode === 9) && !event.shiftKey) {\r\n          needPreventDefault = true;\r\n          if (!this.tabKeyAlreadyDown) {\r\n            this.switchEditColumnHandler(1);\r\n            this.tabKeyAlreadyDown = true;\r\n          }\r\n        }\r\n        //Shift+Tab切换单元格\r\n        if ((event.key === \'Tab\' || event.keyCode === 9) && event.shiftKey) {\r\n          needPreventDefault = true;\r\n          if (!this.tabKeyAlreadyDown) {\r\n            this.switchEditColumnHandler(-1);\r\n            this.tabKeyAlreadyDown = true;\r\n          }\r\n        }\r\n        //Esc完成编辑\r\n        if ((event.key === \'Escape\' || event.keyCode === 27)) {\r\n          needPreventDefault = true;\r\n          this.finishEdit();\r\n        }\r\n        //Shift+Backspace撤销\r\n        if ((event.key === \'Backspace\' || event.keyCode === 8) && event.shiftKey) {\r\n          needPreventDefault = true;\r\n          this.revokeEditingValueHandler();\r\n        }\r\n        if (needPreventDefault) {\r\n          if (event.defaultPrevented) {\r\n            return;\r\n          }\r\n          if (event.preventDefault) {\r\n            event.preventDefault();\r\n          } else {\r\n            event.returnValue = false;\r\n          }\r\n        }\r\n      },\r\n      //检查编辑中单元格 新值与原值是否相同。customDataProps可以传入要检测的列标记，可检测自定义列（此示例未使用此参数）\r\n      checkEditingValueIsChanged(customDataProps) {\r\n        if (customDataProps || this.editingCellInfo.columnOption) {\r\n          let dataProps;\r\n          if (customDataProps) {\r\n            dataProps = customDataProps;\r\n          } else {\r\n            let columnOption = this.editingCellInfo.columnOption;\r\n            dataProps = [columnOption.propId, columnOption.propText];\r\n          }\r\n          let row = this.getEditingRow();\r\n          if (!row) {\r\n            return true;\r\n          }\r\n          let rowOrigin = this.getEditingRowOrigin();\r\n          if (!rowOrigin) {\r\n            return true;\r\n          }\r\n          for (let dataProp of dataProps) {\r\n            if (rowOrigin[dataProp] === null && row[dataProp] === null ||\r\n              rowOrigin[dataProp] === \'\' && row[dataProp] === \'\' ||\r\n              rowOrigin[dataProp] === null && row[dataProp] === \'\' ||\r\n              rowOrigin[dataProp] === \'\' && row[dataProp] === null\r\n            ) {\r\n              return false;\r\n            }\r\n            if (String(rowOrigin[dataProp]) !== String(row[dataProp])) {\r\n              return true;\r\n            }\r\n          }\r\n        }\r\n        return false;\r\n      },\r\n      //获取编辑中行 现数据\r\n      getEditingRow() {\r\n        for (let row of this.tableData) {\r\n          if (row._hiddenRowId === this.editingCellInfo.rowId) {\r\n            return row;\r\n          }\r\n        }\r\n        return {};\r\n      },\r\n      //获取编辑中行 原数据\r\n      getEditingRowOrigin() {\r\n        for (let row of this.tableDataOrigin) {\r\n          if (row._hiddenRowId === this.editingCellInfo.rowId) {\r\n            return row;\r\n          }\r\n        }\r\n        return {};\r\n      },\r\n\r\n      addNewRowHandler() {\r\n        this.tableData.push({_hiddenRowId: this.buildNewRowHiddenId()});\r\n      },\r\n      deleteRowHandler(row) {\r\n        if (row._hiddenRowId.startsWith(\'A\')) {\r\n          for (let rowIndex = 0; rowIndex < this.tableData.length; rowIndex++) {\r\n            if (this.tableData[rowIndex]._hiddenRowId === row._hiddenRowId) {\r\n              this.tableData.splice(rowIndex, 1);\r\n            }\r\n          }\r\n          return;\r\n        }\r\n        if (row._hiddenRowId.startsWith(\'D\')) {\r\n          if (this.changedCellInfo[row._hiddenRowId]) {\r\n            this.$set(this.changedCellInfo, row._hiddenRowId.substring(1), JSON.parse(JSON.stringify(this.changedCellInfo[row._hiddenRowId])));\r\n            this.$delete(this.changedCellInfo, row._hiddenRowId);\r\n          }\r\n          this.$set(row, "_hiddenRowId", row._hiddenRowId.substring(1));\r\n        } else {\r\n          if (this.changedCellInfo[row._hiddenRowId]) {\r\n            this.$set(this.changedCellInfo, \'D\' + row._hiddenRowId, JSON.parse(JSON.stringify(this.changedCellInfo[row._hiddenRowId])));\r\n            this.$delete(this.changedCellInfo, row._hiddenRowId);\r\n          }\r\n          this.$set(row, \'_hiddenRowId\', \'D\' + row._hiddenRowId);\r\n        }\r\n        //处理某些时候点删除，样式不更新的迷之操作\r\n        this.tableData.push({_hiddenRowId: this.buildNewRowHiddenId()});\r\n        this.tableData.pop();\r\n      },\r\n      //获取编辑修改的结果\r\n      getEditResult() {\r\n        this.finishEdit();\r\n        let submitData = {\r\n          update: [],//更新的内容\r\n          add: [],//增加的内容\r\n          delete: [],//删除的内容\r\n        };\r\n        this.tableData.forEach(item => {\r\n          if (item && item._hiddenRowId && item._hiddenRowId.length > 0) {\r\n            let itemTmp = JSON.parse(JSON.stringify(item));\r\n            switch (item._hiddenRowId.substr(0, 1)) {\r\n              case \'A\':\r\n                delete itemTmp._hiddenRowId;\r\n                submitData.add.push(itemTmp);//收集添加对象集合\r\n                break;\r\n              case \'D\':\r\n                if (itemTmp.id !== undefined) {\r\n                  submitData.delete.push(itemTmp.id);//收集删除id集合\r\n                }\r\n                break;\r\n              default:\r\n                for (let rowId in this.changedCellInfo) {\r\n                  if (item._hiddenRowId === rowId) {\r\n                    let itemTmp = {};\r\n                    this.changedCellInfo[rowId][\'_dataPrimaryKey\'] = this.dataPrimaryKey;\r\n                    for (let columnId in this.changedCellInfo[rowId]) {\r\n                      if (this.changedCellInfo[rowId].hasOwnProperty(columnId)) {\r\n                        let propId = this.changedCellInfo[rowId][columnId];\r\n                        itemTmp[propId] = item[propId];\r\n                      }\r\n                    }\r\n                    submitData.update.push(itemTmp);//收集更新对象集合\r\n                  }\r\n                }\r\n                break;\r\n            }\r\n          }\r\n        });\r\n        return submitData;\r\n      },\r\n      //重置记录单元格标记的对象\r\n      resetCell() {\r\n        this.finishEdit();\r\n        this.changedCellInfo = {};\r\n      },\r\n      preventLeavingPage() {\r\n        window.onbeforeunload = () => {\r\n          if (JSON.stringify(this.changedCellInfo) !== (\'{}\')) {\r\n            return \'退出将不保存您填写的数据，确定退出吗？\';\r\n          }\r\n        };\r\n      },\r\n    },\r\n    //使用router时，路由跳转提示表单编辑未保存\r\n    beforeRouteLeave(to, from, next) {\r\n      if (JSON.stringify(this.changedCellInfo) !== (\'{}\')) {\r\n        const answer = window.confirm(\'离开将丢失对表单的修改，确定离开本页？\');\r\n        if (answer) {\r\n          next();\r\n        } else {\r\n          next(false);\r\n        }\r\n      } else {\r\n        next();\r\n      }\r\n    },\r\n    deactivated() {\r\n      this.setEditKeyListener(false);\r\n    },\r\n    destroyed() {\r\n      this.setEditKeyListener(false);\r\n    },\r\n  };\r\n<\/script>\r\n\r\n<style scoped>\r\n  *, div, span, td, input {\r\n    font-size: 14px;\r\n    font-family: \'Arial\', "Microsoft YaHei", serif;\r\n  }\r\n\r\n  /*去除表格的行中，上下padding，统一行高*/\r\n  .el-table /deep/ td {\r\n    padding: 0;\r\n    line-height: 30px;\r\n    height: 30px;\r\n  }\r\n\r\n  /*调整单元格模板中div与单元格一样大*/\r\n  .el-table /deep/ .cell {\r\n    -webkit-box-sizing: border-box;\r\n    box-sizing: border-box;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    white-space: normal;\r\n    word-break: break-all;\r\n    line-height: 30px;\r\n    padding: 0 0 0 10px;\r\n  }\r\n\r\n  /*去除element-ui编辑框的padding*/\r\n  /deep/ .el-input__inner {\r\n    padding: 0;\r\n    font-size: 14px;\r\n    box-sizing: border-box;\r\n    height: 30px;\r\n    line-height: 30px;\r\n  }\r\n\r\n  /*去除element-ui编辑框的各种小图标或按钮*/\r\n  /deep/ .el-input__suffix {\r\n    display: none;\r\n  }\r\n\r\n  /deep/ .el-input__prefix {\r\n    display: none;\r\n  }\r\n\r\n  /*缩小button中的padding*/\r\n  .el-button--mini, .el-button--mini.is-round {\r\n    padding: 5px 5px;\r\n  }\r\n\r\n  /deep/ .pre-add-row /deep/ td {\r\n    /*background-color: red !important;*/\r\n    background-image: url(\'./static/img/grid/pre_add_corner.png\') !important;\r\n    background-position: 0 0;\r\n    background-size: 8px;\r\n    background-repeat: no-repeat;\r\n  }\r\n\r\n  /deep/ .pre-delete-row /deep/ td {\r\n    /*background-color: red !important;*/\r\n    background-image: url(\'./static/img/grid/pre_delete_corner.png\') !important;\r\n    background-position: 0 0;\r\n    background-size: 8px;\r\n    background-repeat: no-repeat;\r\n  }\r\n\r\n  /deep/ .pre-update-cell {\r\n    /*background-color: red !important;*/\r\n    background-image: url(\'./static/img/grid/pre_update_corner.png\');\r\n    background-position: 0 0;\r\n    background-size: 8px;\r\n    background-repeat: no-repeat;\r\n  }\r\n\r\n  /*input输入框为number类型时不显示箭头*/\r\n  /deep/ input::-webkit-outer-spin-button,\r\n  /deep/ input::-webkit-inner-spin-button {\r\n    -webkit-appearance: none;\r\n  }\r\n\r\n  /deep/ input[type="number"] {\r\n    -moz-appearance: textfield;\r\n  }\r\n\r\n\r\n</style>\r\n']}])},"06d4":function(e,n){e.exports="data:image/png;base64,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"},"549a":function(e,n){e.exports="data:image/png;base64,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"},"56d7":function(e,n,t){"use strict";t.r(n),t("cadf"),t("551c"),t("f751"),t("097d");var i=t("a026"),r=(t("456d"),t("20d6"),t("7514"),t("ac4d"),t("8a81"),t("f559"),t("ac6a"),t("bc3a")),l=t.n(r),o={name:"TableCellEdit",data:function(){return{tableData:void 0,tableDataOrigin:[],editingCellInfo:{rowId:void 0,columnId:void 0,columnOption:void 0},changedCellInfo:{},dataPrimaryKey:"id",columnOption:[{columnKey:"column1",minWidth:"100px",label:"文字",propId:"text",propText:"text",editType:"Input"},{columnKey:"column2",minWidth:"100px",label:"文字1",propId:"text1",propText:"text1",editType:"Input"},{columnKey:"column3",propId:"date",propText:"date",editType:"DatePicker",width:"150px",minWidth:"150px",label:"时间编辑"},{columnKey:"column4",minWidth:"100px",label:"数字",propId:"number",propText:"number",editType:"InputNumber"},{columnKey:"column5",minWidth:"140px",label:"不能编辑",propId:"textNoEdit",propText:"textNoEdit"},{columnKey:"column6",minWidth:"100px",label:"选择",propId:"selectValue",propText:"selectName",editType:"Select",selectList:[{value:10,label:"这个选项会被fetchSelectListData()方法中的值覆盖"}]}],newRowHiddenId:1,tabKeyAlreadyDown:!1}},mounted:function(){},created:function(){this.preventLeavingPage(),this.fetchData(),this.fetchSelectListData()},methods:{refreshData:function(){var e=this;"{}"!==JSON.stringify(this.changedCellInfo)?this.$confirm('检测到您有未提交保存的修改<br />刷新将<span style="color:#E6A23C;font-weight: bold">丢失未保存的修改</span>，是否继续？',{dangerouslyUseHTMLString:!0}).then((function(){e.fetchData()})).catch((function(){})):this.fetchData()},fetchData:function(){var e=this;l.a.post("/getTableDataApi").then((function(n){var t=n.data;e.setTableData(t.tableData)}))},fetchSelectListData:function(){var e=this;l.a.post("/getSelectListDataApi").then((function(n){var t=n.data;e.columnOption.forEach((function(e){"column6"===e.columnKey&&(e.selectList=t.selectListData)}))}))},submitHandler:function(){var e=this,n=this.getEditResult();l.a.post("/setTableDataApi",n).then((function(n){n.data.result&&(e.fetchData(),e.$notify({title:"提交成功，查看控制台",type:"success"}))}))},setTableData:function(e){this.resetCell(),this.tableData=e,this.initTableDataAndTableDataOrigin()},getRowState:function(e){return e?e.startsWith("D")?"delete":e.startsWith("A")?"add":void 0:""},tableRowClassName:function(e){var n=e.row;return e.rowIndex,n._hiddenRowId?n._hiddenRowId.startsWith("A")?"pre-add-row":n._hiddenRowId.startsWith("D")?"pre-delete-row":"":""},tableCellClassName:function(e){var n=e.row,t=e.column,i=(e.rowIndex,e.columnIndex,"");return this.changedCellInfo[n._hiddenRowId]&&this.changedCellInfo[n._hiddenRowId][t.columnKey]&&(i+=" pre-update-cell"),i},buildNewRowHiddenId:function(){var e="A"+(Array(16).join("0")+this.newRowHiddenId).slice(-16);return this.newRowHiddenId++,e},initTableDataAndTableDataOrigin:function(){var e=1,n=!0,t=!1,i=void 0;try{for(var r,l=this.tableData[Symbol.iterator]();!(n=(r=l.next()).done);n=!0){var o=r.value;this.$set(o,"_hiddenRowId",(Array(16).join("0")+e).slice(-16)),e++}}catch(e){t=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(t)throw i}}this.tableDataOrigin=JSON.parse(JSON.stringify(this.tableData))},buildCellRef:function(e,n){return"Cell_"+e+"_"+n},isEditingCell:function(e,n,t){return t&&this.editingCellInfo.rowId===e&&this.editingCellInfo.columnId===n},cellClickHandler:function(e,n){this.startEdit(e,n)},startEdit:function(e,n){this.setEditKeyListener(!1),this.setEditKeyListener(!0),e&&e._hiddenRowId&&(this.editingCellInfo.rowId=e._hiddenRowId),n&&n.columnKey&&(this.editingCellInfo.columnId=n.columnKey),n&&(this.editingCellInfo.columnOption=n),this.editingCellFocusAndSelect()},finishEdit:function(){this.editCellBlurHandler(),this.editingCellInfo={rowId:void 0,columnId:void 0,columnOption:void 0},this.setEditKeyListener(!1)},editingCellFocusAndSelect:function(){var e=this,n=this.editingCellInfo.rowId,t=this.editingCellInfo.columnId;this.$nextTick((function(){if(e.editingCellInfo.columnOption)switch(e.editingCellInfo.columnOption.editType){case"Input":case"InputNumber":var i=e.tableData.find((function(n){return n._hiddenRowId===e.editingCellInfo.rowId}))[e.editingCellInfo.columnOption.propId];e.$refs[e.buildCellRef(e.editingCellInfo.rowId,e.editingCellInfo.columnId)][0].value=void 0===i?"":i}var r=e.$refs[e.buildCellRef(n,t)];r&&0<r.length&&(r[0].focus&&r[0].focus(),r[0].select&&r[0].select())}))},editCellBlurHandler:function(){this.setEditingValueToTableData(),this.setEditingCellInfoToChangedCellInfo(this.checkEditingValueIsChanged())},setEditingValueToTableData:function(){var e=this.editingCellInfo.columnOption;if(e){var n=this.getEditingRow();switch(e.editType){case"Input":case"InputNumber":var t=this.$refs[this.buildCellRef(this.editingCellInfo.rowId,this.editingCellInfo.columnId)][0].value;this.$set(n,e.propId,t);break;case"Select":case"SelectGroup":var i=e.selectList,r=null,l=!0,o=!1,d=void 0;try{for(var a,s=i[Symbol.iterator]();!(l=(a=s.next()).done);l=!0){var c=a.value;c.value===n[e.propId]&&(r=c.label)}}catch(t){o=!0,d=t}finally{try{l||null==s.return||s.return()}finally{if(o)throw d}}0<=e.selectList.findIndex((function(t){return t.value===n[e.propId]}))&&(this.$set(n,e.propId,n[e.propId]),this.$set(n,e.propText,r))}}},setEditingCellInfoToChangedCellInfo:function(e){if(this.editingCellInfo.columnOption){var n=this.editingCellInfo.rowId,t=this.editingCellInfo.columnId,i=this.editingCellInfo.columnOption.propId;this.changedCellInfo[n]||(this.changedCellInfo[n]={}),e?this.changedCellInfo[n][t]=i:(delete this.changedCellInfo[n][t],0===Object.keys(this.changedCellInfo[n]).length&&delete this.changedCellInfo[n])}},revokeEditingValueHandler:function(){var e=this.editingCellInfo.columnOption,n=e.propId,t=e.propText,i=!0,r=!1,l=void 0;try{for(var o,d=this.tableDataOrigin[Symbol.iterator]();!(i=(o=d.next()).done);i=!0){var a=o.value;if(a._hiddenRowId===this.editingCellInfo.rowId){var s=this.getEditingRow();switch(this.$set(s,n,a[n]),this.$set(s,t,a[t]),e.editType){case"Input":case"InputNumber":this.$refs[this.buildCellRef(this.editingCellInfo.rowId,this.editingCellInfo.columnId)][0].value=a[n]}}}}catch(e){r=!0,l=e}finally{try{i||null==d.return||d.return()}finally{if(r)throw l}}this.finishEdit()},switchEditColumnHandler:function(e){var n=this.columnOption.filter((function(e){return e.editType}));if(this.editingCellInfo.rowId&&this.editingCellInfo.columnId)for(var t=0;t<n.length;t++)if(n[t].columnKey===this.editingCellInfo.columnId){var i=t;if(0<e?i++:e<0&&i--,0<e&&i<n.length||e<0&&0<=i)n[i]&&(this.$refs[this.buildCellRef(this.editingCellInfo.rowId,this.editingCellInfo.columnId)][0].blur(),"DatePicker"===this.editingCellInfo.columnOption.editType&&this.editCellBlurHandler(),this.startEdit(void 0,n[i]));else{for(var r=0;r<this.tableData.length&&this.tableData[r]._hiddenRowId!==this.editingCellInfo.rowId;r++);if(0<e){r>=this.tableData.length-1&&this.addNewRowHandler();var l=this.tableData[++r];this.startEdit(l,n[0])}else if(e<0&&0<r){var o=this.tableData[--r];this.startEdit(o,n.slice(-1)[0])}}break}},setEditKeyListener:function(e){if(e)window.addEventListener("keydown",this.editCellKeyDownHandler,!0),window.addEventListener("keyup",this.editCellKeyUpHandler,!0);else try{window.removeEventListener("keydown",this.editCellKeyDownHandler,!0),window.removeEventListener("keyup",this.editCellKeyUpHandler,!0)}catch(e){}},editCellKeyUpHandler:function(e){"Tab"!==e.key&&9!==e.keyCode||(this.tabKeyAlreadyDown=!1)},editCellKeyDownHandler:function(e){var n=!1;if("Tab"!==e.key&&9!==e.keyCode||e.shiftKey||(n=!0,this.tabKeyAlreadyDown||(this.switchEditColumnHandler(1),this.tabKeyAlreadyDown=!0)),"Tab"!==e.key&&9!==e.keyCode||!e.shiftKey||(n=!0,this.tabKeyAlreadyDown||(this.switchEditColumnHandler(-1),this.tabKeyAlreadyDown=!0)),"Escape"!==e.key&&27!==e.keyCode||(n=!0,this.finishEdit()),"Backspace"!==e.key&&8!==e.keyCode||!e.shiftKey||(n=!0,this.revokeEditingValueHandler()),n){if(e.defaultPrevented)return;e.preventDefault?e.preventDefault():e.returnValue=!1}},checkEditingValueIsChanged:function(e){if(e||this.editingCellInfo.columnOption){var n;if(e)n=e;else{var t=this.editingCellInfo.columnOption;n=[t.propId,t.propText]}var i=this.getEditingRow();if(!i)return!0;var r=this.getEditingRowOrigin();if(!r)return!0;var l=!0,o=!1,d=void 0;try{for(var a,s=n[Symbol.iterator]();!(l=(a=s.next()).done);l=!0){var c=a.value;if(null===r[c]&&null===i[c]||""===r[c]&&""===i[c]||null===r[c]&&""===i[c]||""===r[c]&&null===i[c])return!1;if(String(r[c])!==String(i[c]))return!0}}catch(e){o=!0,d=e}finally{try{l||null==s.return||s.return()}finally{if(o)throw d}}}return!1},getEditingRow:function(){var e=!0,n=!1,t=void 0;try{for(var i,r=this.tableData[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var l=i.value;if(l._hiddenRowId===this.editingCellInfo.rowId)return l}}catch(e){n=!0,t=e}finally{try{e||null==r.return||r.return()}finally{if(n)throw t}}return{}},getEditingRowOrigin:function(){var e=!0,n=!1,t=void 0;try{for(var i,r=this.tableDataOrigin[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var l=i.value;if(l._hiddenRowId===this.editingCellInfo.rowId)return l}}catch(e){n=!0,t=e}finally{try{e||null==r.return||r.return()}finally{if(n)throw t}}return{}},addNewRowHandler:function(){this.tableData.push({_hiddenRowId:this.buildNewRowHiddenId()})},deleteRowHandler:function(e){if(e._hiddenRowId.startsWith("A"))for(var n=0;n<this.tableData.length;n++)this.tableData[n]._hiddenRowId===e._hiddenRowId&&this.tableData.splice(n,1);else e._hiddenRowId.startsWith("D")?(this.changedCellInfo[e._hiddenRowId]&&(this.$set(this.changedCellInfo,e._hiddenRowId.substring(1),JSON.parse(JSON.stringify(this.changedCellInfo[e._hiddenRowId]))),this.$delete(this.changedCellInfo,e._hiddenRowId)),this.$set(e,"_hiddenRowId",e._hiddenRowId.substring(1))):(this.changedCellInfo[e._hiddenRowId]&&(this.$set(this.changedCellInfo,"D"+e._hiddenRowId,JSON.parse(JSON.stringify(this.changedCellInfo[e._hiddenRowId]))),this.$delete(this.changedCellInfo,e._hiddenRowId)),this.$set(e,"_hiddenRowId","D"+e._hiddenRowId)),this.tableData.push({_hiddenRowId:this.buildNewRowHiddenId()}),this.tableData.pop()},getEditResult:function(){var e=this;this.finishEdit();var n={update:[],add:[],delete:[]};return this.tableData.forEach((function(t){if(t&&t._hiddenRowId&&0<t._hiddenRowId.length){var i=JSON.parse(JSON.stringify(t));switch(t._hiddenRowId.substr(0,1)){case"A":delete i._hiddenRowId,n.add.push(i);break;case"D":void 0!==i.id&&n.delete.push(i.id);break;default:for(var r in e.changedCellInfo)if(t._hiddenRowId===r){var l={};for(var o in e.changedCellInfo[r]._dataPrimaryKey=e.dataPrimaryKey,e.changedCellInfo[r])if(e.changedCellInfo[r].hasOwnProperty(o)){var d=e.changedCellInfo[r][o];l[d]=t[d]}n.update.push(l)}}}})),n},resetCell:function(){this.finishEdit(),this.changedCellInfo={}},preventLeavingPage:function(){var e=this;window.onbeforeunload=function(){if("{}"!==JSON.stringify(e.changedCellInfo))return"退出将不保存您填写的数据，确定退出吗？"}}},beforeRouteLeave:function(e,n,t){"{}"!==JSON.stringify(this.changedCellInfo)?window.confirm("离开将丢失对表单的修改，确定离开本页？")?t():t(!1):t()},deactivated:function(){this.setEditKeyListener(!1)},destroyed:function(){this.setEditKeyListener(!1)}},d=(t("dc1c"),t("2877")),a={name:"App",components:{TableCellEdit:Object(d.a)(o,(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("el-form",{staticStyle:{height:"20px"},attrs:{inline:""}},[t("el-form-item",{staticStyle:{"margin-bottom":"0"}},[t("el-button",{staticClass:"custom-button-in-toolbar ",attrs:{type:"primary",plain:"",size:"mini",icon:"el-icon-refresh"},on:{click:e.refreshData}},[e._v("刷新\n      ")])],1),t("el-form-item",{staticStyle:{"margin-bottom":"0"}},[t("el-button",{attrs:{type:"primary",plain:"",size:"mini",icon:"el-icon-circle-plus"},on:{click:e.addNewRowHandler}},[e._v("新增")])],1),t("el-form-item",{staticStyle:{"margin-bottom":"0"}},[t("el-button",{attrs:{type:"success",plain:"",size:"mini",icon:"el-icon-success"},on:{click:e.submitHandler}},[e._v("提交保存")])],1),t("el-form-item",{staticStyle:{float:"right","margin-bottom":"0"}},[t("el-popover",{attrs:{trigger:"hover",placement:"bottom"}},[t("el-button",{attrs:{slot:"reference",type:"warning",plain:"",size:"mini"},slot:"reference"},[t("i",{staticClass:"el-icon-question"}),e._v("使用帮助")]),t("div",{staticStyle:{height:"25px"}},[t("span",{staticStyle:{color:"#ff7435",display:"inline-block","font-weight":"bold"}},[e._v("所有操作均在“提交保存”后生效")])]),t("div",{staticStyle:{height:"25px"}},[t("span",{staticStyle:{display:"inline-block","font-weight":"bold",width:"70px"}},[e._v("角标颜色")]),t("el-tag",{staticStyle:{"font-size":"12px","margin-right":"5px"},attrs:{size:"mini"}},[e._v("预增加")]),t("el-tag",{staticStyle:{"font-size":"12px","margin-right":"5px"},attrs:{size:"mini",type:"warning"}},[e._v("预修改")]),t("el-tag",{staticStyle:{"font-size":"12px","margin-right":"5px"},attrs:{size:"mini",type:"danger"}},[e._v("预删除")])],1),t("div",{staticStyle:{height:"25px"}},[t("span",{staticStyle:{"font-weight":"bold",color:"#666"}},[e._v("快捷键（编辑单元格时）：")])]),t("div",{staticStyle:{"margin-left":"5px"}},[t("div",{staticStyle:{height:"25px"}},[t("span",{staticStyle:{display:"inline-block","font-weight":"bold",width:"80px"}},[e._v("下一单元格")]),t("el-tag",{staticStyle:{"font-size":"12px",margin:"0 5px"},attrs:{size:"mini"}},[e._v("Tab")])],1),t("div",{staticStyle:{height:"25px"}},[t("span",{staticStyle:{display:"inline-block","font-weight":"bold",width:"80px"}},[e._v("上一单元格")]),t("el-tag",{staticStyle:{"font-size":"12px",margin:"0 5px"},attrs:{size:"mini"}},[e._v("Shift")]),t("span",[e._v("+")]),t("el-tag",{staticStyle:{"font-size":"12px",margin:"0 5px"},attrs:{size:"mini"}},[e._v("Tab")])],1),t("div",{staticStyle:{height:"25px"}},[t("span",{staticStyle:{display:"inline-block","font-weight":"bold",width:"80px"}},[e._v("撤销修改")]),t("el-tag",{staticStyle:{"font-size":"12px",margin:"0 5px"},attrs:{size:"mini"}},[e._v("Shift")]),t("span",[e._v("+")]),t("el-tag",{staticStyle:{"font-size":"12px",margin:"0 5px"},attrs:{size:"mini"}},[e._v("Backspace")])],1),t("div",{staticStyle:{height:"25px"}},[t("span",{staticStyle:{display:"inline-block","font-weight":"bold",width:"80px"}},[e._v("完成编辑")]),t("el-tag",{staticStyle:{"font-size":"12px",margin:"0 5px"},attrs:{size:"mini"}},[e._v("Esc")])],1)])],1)],1)],1),t("el-table",{ref:"Table",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"400px","row-class-name":e.tableRowClassName,"cell-class-name":e.tableCellClassName}},[t("el-table-column",{attrs:{fixed:"left",type:"index",width:"50px",label:"序号",align:"center"}}),e._l(e.columnOption,(function(n){return t("el-table-column",{key:n.prop,attrs:{"min-width":n.minWidth,width:n.width,"column-key":n.columnKey,label:n.label,prop:n.propText},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isEditingCell(i.row._hiddenRowId,n.columnKey,n.editType),expression:"!isEditingCell(scope.row._hiddenRowId,item.columnKey,item.editType)"}],staticStyle:{"min-height":"30px"},style:{color:n.color},on:{click:function(t){return e.cellClickHandler(i.row,n)}}},[t("span",[e._v(e._s(i.row[n.propText]))])]),e.isEditingCell(i.row._hiddenRowId,n.columnKey,n.editType)?t("div",{staticStyle:{display:"table"}},[t("div",{staticStyle:{display:"table-cell",width:"100%"}},["Input"===n.editType?t("input",{ref:e.buildCellRef(i.row._hiddenRowId,n.columnKey),refInFor:!0,staticClass:"el-input el-input__inner",staticStyle:{width:"100%"},on:{blur:e.editCellBlurHandler}}):e._e(),"InputNumber"===n.editType?t("input",{ref:e.buildCellRef(i.row._hiddenRowId,n.columnKey),refInFor:!0,staticClass:"el-input el-input__inner",staticStyle:{width:"100%"},attrs:{type:"Number",placeholder:"输入数字"},on:{blur:e.editCellBlurHandler}}):e._e(),"DatePicker"===n.editType?t("el-date-picker",{ref:e.buildCellRef(i.row._hiddenRowId,n.columnKey),refInFor:!0,staticStyle:{width:"100%"},attrs:{clearable:!1,size:"mini","prefix-icon":" ",placeholder:"选择日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},on:{blur:e.editCellBlurHandler},model:{value:i.row[n.propId],callback:function(t){e.$set(i.row,n.propId,t)},expression:"scope.row[item.propId]"}}):e._e(),"Select"===n.editType?t("el-select",{ref:e.buildCellRef(i.row._hiddenRowId,n.columnKey),refInFor:!0,attrs:{width:"100%",filterable:"","automatic-dropdown":!0,placeholder:"请选择"},on:{blur:e.editCellBlurHandler,change:e.editCellBlurHandler},model:{value:i.row[n.propId],callback:function(t){e.$set(i.row,n.propId,t)},expression:"scope.row[item.propId]"}},e._l(n.selectList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e()],1),t("div",{staticStyle:{margin:"0"},style:{width:"add"===e.getRowState(i.row._hiddenRowId)?0:"26px"}},[t("el-popconfirm",{attrs:{placement:"right",title:"确定撤销更改？"},on:{onConfirm:e.revokeEditingValueHandler}},["add"!==e.getRowState(i.row._hiddenRowId)?t("el-button",{staticStyle:{margin:"0"},attrs:{slot:"reference",title:"撤销更改(Shift+Backspace)",type:"danger",plain:"",size:"mini",icon:"el-icon-refresh-left"},slot:"reference"}):e._e()],1)],1)]):e._e()]}}],null,!0)})})),t("el-table-column",{attrs:{width:"120px",prop:"selectValue",align:"center",label:"选择id(普通列)"}}),t("el-table-column",{attrs:{width:"120px",prop:"selectName",align:"center",label:"选择值(普通列)"}}),t("el-table-column",{attrs:{width:"60px",fixed:"right",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-button",{staticStyle:{"margin-left":"-10px","font-size":"12px"},attrs:{title:"delete"===e.getRowState(n.row._hiddenRowId)?"取消删除":"删除",type:"delete"===e.getRowState(n.row._hiddenRowId)?"success":"danger",plain:"",size:"mini",icon:"delete"===e.getRowState(n.row._hiddenRowId)?"el-icon-refresh-left":"el-icon-delete"},on:{click:function(t){return e.deleteRowHandler(n.row)}}})]}}])})],2)],1)}),[],!1,null,"351764dc",null).exports},data:function(){return{}}},s=Object(d.a)(a,(function(){var e=this.$createElement,n=this._self._c||e;return n("div",{attrs:{id:"app"}},[n("table-cell-edit")],1)}),[],!1,null,null,null).exports,c=t("5c96"),p=t.n(c);t("0fae"),i.default.config.productionTip=!1,i.default.use(p.a),t("9523"),new i.default({el:"#app",components:{App:s},template:"<App/>"})},9523:function(e,n,t){"use strict";t.r(n);var i=t("75fc"),r=(t("ac4d"),t("8a81"),t("ac6a"),t("96eb")),l=t.n(r);l.a.mock("/getSelectListDataApi","post",{selectListData:[{value:1,label:"1黄金糕"},{value:2,label:"2双皮奶"},{value:3,label:"3蚵仔煎"},{value:4,label:"4龙须面"},{value:5,label:"5北京烤鸭"}]});var o=[{id:10001,date:"2016-05-02",text:"张三",text1:"ff",number:511,textNoEdit:"不能编辑的列",selectValue:1,selectName:"1黄金糕"},{id:10002,date:"2017-05-04",text:"李四",text1:"vv",number:11,textNoEdit:"11",selectValue:2,selectName:"2双皮奶"},{id:10003,date:"2019-01-01",text:"王五",text1:"cc",number:213,textNoEdit:"一段文字",selectValue:3,selectName:"3蚵仔煎"},{id:10004,date:"2019-05-03",text:"赵六",text1:"aa",number:151,textNoEdit:"另一段文字",selectValue:4,selectName:"4龙须面"}];l.a.mock("/getTableDataApi","post",(function(e){return{tableData:o}}));var d=0,a=!1;l.a.mock("/setTableDataApi","post",(function(e){var n=JSON.parse(e.body);if(!a){var t=!0,r=!1,l=void 0;try{for(var s,c=o[Symbol.iterator]();!(t=(s=c.next()).done);t=!0){var p=s.value;void 0!==p.id&&(d=Math.max(d,p.id))}}catch(e){r=!0,l=e}finally{try{t||null==c.return||c.return()}finally{if(r)throw l}}a=!0}n.add.forEach((function(e){e.id||(e.id=++d)})),o.push.apply(o,Object(i.a)(n.add)),o=o.filter((function(e){return-1===n.delete.indexOf(e.id)}));var u=!0,h=!1,f=void 0;try{for(var w,g=n.update[Symbol.iterator]();!(u=(w=g.next()).done);u=!0){var m=w.value,A=!0,I=!1,b=void 0;try{for(var y,C=o[Symbol.iterator]();!(A=(y=C.next()).done);A=!0){var v=y.value;if(v.id===m.id)for(var x in m)m.hasOwnProperty(x)&&(v[x]=m[x])}}catch(e){I=!0,b=e}finally{try{A||null==C.return||C.return()}finally{if(I)throw b}}}}catch(e){h=!0,f=e}finally{try{u||null==g.return||g.return()}finally{if(h)throw f}}return{result:!0}}))},dc1c:function(e,n,t){"use strict";var i=t("fa71");t.n(i).a},eecd:function(e,n){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAA4SURBVHjajNBJEQAgEANBBmVIxekigc47lWM6d2aB9jIlxiQxqU42JmeS1wmehGM/Rg8AAP//AwCnSgL75sgM0QAAAABJRU5ErkJggg=="},fa71:function(e,n,t){var i=t("06b4");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals),(0,t("499e").default)("bada497e",i,!0,{sourceMap:!0,shadowMode:!1})}});